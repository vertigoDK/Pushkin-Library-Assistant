# Сайт Библиотеки Пушкина

## Содержание

- [Установка и настройка](#установка-и-настройка)
  - [1. Клонирование репозитория](#1-клонирование-репозитория)
  - [2. Создание виртуального окружения](#2-создание-виртуального-окружения)
  - [3. Активация виртуального окружения](#3-активация-виртуального-окружения)
  - [4. Установка зависимостей](#4-установка-зависимостей)
  - [5. Настройка файла `.env`](#5-настройка-файла-env)
  - [6. Применение миграций](#6-применение-миграций)
  - [7. Запуск сервера разработки](#7-запуск-сервера-разработки)
- [Структура проекта](#структура-проекта)
- [Установка и настройка Flowise](#установка-и-настройка-flowise)
  - [1. Установка Node.js](#1-установка-nodejs)
  - [2. Установка Flowise](#2-установка-flowise)
  - [3. Запуск Flowise](#3-запуск-flowise)
  - [4. Запуск Flowise с аутентификацией](#4-запуск-flowise-с-аутентификацией)
  - [5. Открытие Flowise в браузере](#5-открытие-flowise-в-браузере)
- [Frontend](#frontend)
  - [Построенный проект](#построенный-проект)
- [Работа с Django](#работа-с-django)
  - [Создание суперпользователя](#создание-суперпользователя)
  - [Сбор статических файлов](#сбор-статических-файлов)
  - [Запуск тестов](#запуск-тестов)
  - [Работа с переводами](#работа-с-переводами)
    - [Создание переводов](#создание-переводов)
    - [Компиляция переводов](#компиляция-переводов)
  - [Использование Django Shell](#использование-django-shell)
  - [Доступ к административной панели](#доступ-к-административной-панели)

---

## Установка и настройка

### 1. Клонирование репозитория

```sh
git clone https://github.com/trr69/Pushkin-Library-Assistant.git
cd Pushkin-Library-Assistant
```

### 2. Создание виртуального окружения

```sh
python -m venv venv
```

### 3. Активация виртуального окружения

- **Для Unix/MacOS:**

  ```sh
  source venv/bin/activate
  ```

- **Для Windows:**

  ```sh
  venv\Scripts\activate
  ```

### 4. Установка зависимостей

```sh
pip install -r requirements.txt
```

### 5. Настройка файла `.env`

Создайте файл `.env` в корневом каталоге проекта и добавьте следующие переменные:

```env
DEBUG=False
SECRET_KEY=<django-secret-key>  # Получить ключ можно здесь: https://djecrety.ir/
DATABASE_NAME=db.sqlite3
FLOWISE_CHATFLOW=<ID чата Flowise>
FLOWISE_HOST=<Хост Flowise>
```

### 6. Применение миграций

```sh
python manage.py migrate
```

### 7. Запуск сервера разработки

```sh
python manage.py runserver
```



---

## Структура проекта

- **base/** — главный модуль проекта
  - `manage.py` — основной скрипт управления проектом
  - `settings.py` — настройки проекта
  - `urls.py` — маршрутизация URL
  - `models.py` — определение моделей данных
  - `views.py` — представления приложения

- **core/** — главное приложение

- **app/** — содержит все приложения
  - **api/** — Работа с книгами (Ирбис)
    - Отвечает за взаимодействие с системой Ирбис для работы DOSAI
    - **Основные функции**: поиск книг и выдача DOSAI

  - **chatbot_app/** — Приложение чат-бота
    - Реализует функциональность чат-бота для взаимодействия с пользователями (отдельная страница)
    - **Основные функции**: ответы на часто задаваемые вопросы, помощь в навигации по сайту, предоставление информации о доступных книгах и услугах

  - **courses_app/** — Приложение для курсов
    - Управляет библиотечными курсами
    - **Основные функции**: создание и управление курсами

  - **events_app/** — Приложение для событий
    - Управляет событиями и мероприятиями, проводимыми библиотекой
    - **Основные функции**: создание и управление событиями

  - **new_book_app/** — Приложение для добавления новинок книг
    - Отвечает за добавление новых поступлений книг в библиотеку
    - **Основные функции**: добавление информации о новых книгах

  - **news_app/** — Приложение для новостей
    - Отвечает за публикацию новостей и объявлений библиотеки
    - **Основные функции**: создание и управление новостями

  - **time_app/** — Приложение для изменения расписания
    - Управляет расписанием работы и отдыха библиотеки
    - **Основные функции**: управление расписанием работы библиотеки

- **templates/** — шаблоны HTML для рендеринга страниц
- **static/** — статические файлы (CSS, JavaScript, изображения, шрифты)
- **conf/locale/** — конфигурация переводов
  - **en/** — английская локализация
  - **kk/** — казахская локализация
  - **ru/** — русская локализация
- **database/** — файлы базы данных проекта
- **media/** — хранение загружаемых пользователями файлов



---

## Установка и настройка Flowise

**Flowise** — инструмент с открытым исходным кодом, позволяющий разработчикам создавать индивидуальные потоки оркестрации LLM и агенты искусственного интеллекта.

### 1. Установка Node.js

Скачайте и установите Node.js версии >= 18.15.0 с [официального сайта](https://nodejs.org/).

### 2. Установка Flowise

Выполните следующую команду для установки Flowise:

```sh
npm install -g flowise
```

### 3. Запуск Flowise

Для запуска Flowise используйте команду:

```sh
npx flowise start
```

### 4. Запуск Flowise с аутентификацией

Если требуется запуск с использованием имени пользователя и пароля:

```sh
npx flowise start --FLOWISE_USERNAME=user --FLOWISE_PASSWORD=1234
```

### 5. Открытие Flowise в браузере

После запуска Flowise откройте браузер и перейдите по адресу:

[http://localhost:3000](http://localhost:3000)

### Docker

#### 1. Установка Docker

- Скачайте и установите Docker с официального сайта.
    
- Проверьте установку Docker, выполнив команду:

```sh
docker --version
```


#### Docker Compose

Перейдите в папку Docker в корне проекта.

Скопируйте файл `.env.example` и вставьте его как другой файл с именем `.env`.

**Запустите**:

```
docker compose up -d
```

Откройте: http://localhost:3000

Вы можете отключить docker, выполнив:

```
docker compose stop
```


----

## Frontend

### Построенный проект

Построенный фронтенд находится в ветки `frontend` в следующем каталоге:

- **build/**
  - **css/**
  - **js/**
  - **img/**

---

## Работа с Django

### Создание суперпользователя

Для доступа к административной панели `Django` необходимо создать суперпользователя:

```sh
python manage.py createsuperuser
```

Следуйте инструкциям в терминале для установки имени пользователя, адреса электронной почты и пароля.

### Сбор статических файлов

Перед развертыванием на продакшен-сервере необходимо собрать все статические файлы:


```sh
python manage.py collectstatic
```

Эта команда соберет все статические файлы в одну директорию, определенную в настройках проекта `staticfiles/`. 

### Запуск тестов

Чтобы запустить тесты для вашего приложения, вы можете запустить их с помощью:


```sh
python manage.py test
```


### Работа с переводами

#### Создание переводов

Для создания переводов используйте команду:

```sh
django-admin makemessages -d djangojs -l en
```

Эта команда создаст файл перевода для английского языка.

#### Компиляция переводов

После внесения изменений в файлы переводов выполните компиляцию:

```sh
django-admin compilemessages
```

Эта команда скомпилирует переводы для использования в вашем приложении.

---

### Использование `Django Shell`

Django предоставляет интерактивную оболочку для взаимодействия с проектом:

```sh
python manage.py shell
```

Это полезно для быстрого тестирования моделей и выполнения операций с базой данных.


### Доступ к административной панели

Административная панель Django позволяет управлять моделями и данными:

    Запустите сервер разработки:

    sh

```sh
python manage.py runserver
```

Перейдите по адресу http://localhost:8000/admin/

Войдите с использованием учетных данных суперпользователя